# これなに？
鉱物コレクションを管理するために作成したアプリケーションです  
デスクトップアプリケーションとして作成しておりOFFLINEで動作します   
通常操作では外部と通信しないので安心してお使いいただけます

# Version
お使いのVersionは 1.0.0 です  
## アップデート方法
すでに過去Versionをご使用の方はZIPファイル内 [MineralManager.exe] *のみ* を既存フォルダに上書してください  
<font color="Tomato">同梱の [DB] フォルダをコピーすると今まで登録されたデータが上書されてしまいます</font>  
## 履歴
* ver 1.0.0
    * (NEW) 新機能
        * 初期リリース
* ver 0.52
    * (NEW) 新機能
        * 当初からの要望を隠し機能として実装
        * 詳細画面.購入日時にカレンダ機能を実装
        * 詳細画面.IDを編集可能項目に変更
    * (BugFix) 下記問題を修正
        * 詳細画面.金額に入力を行ったあと、削除することができない(¥0 として更新されNULL値とならない)
        * 詳細画面.購入日時に入力を行ったあと、削除することができない(更新されずNULL値とならない)
        * 詳細画面.購入金額を入力時に不要な補完が入る(0が補完される)
        * <font color="Tomato">(致命バグ)</font>メイン画面で検索を行ったあと追加ボタンを押下すると、採番されるIDが「現在」表示されている行の最大値 + 1 となり一意性が担保されない
    * (Other) その他
        * 各ボタンにアイコンを追加
        * 画面ごとの用語を統一(Update → Save 等)
        * 詳細画面の入力補助機能を正式採用
* ver 0.51  
    * (NEW) 新機能  
        * 画像閲覧画面にPan and Zoom機能を実装  
        * 写真を使ったラベルデザイン(PhotoLabel)を追加  
        * 詳細画面の [MainMineral], [SubMineral], [Location], [Country] に入力補助機能を実装  
    * (BugFix) 下記問題を修正
        * 詳細画面.画像2 ~ 4 に画像以外のファイルをドラッグ&ドロップした際にエラーメッセージが表示されない  
        * 詳細画面.SubMineral1に入力がない状態でSubMineral2 ~ 3を入力しUpdateした場合、SubMineralの登録が行われない  
        * ラベルデザイン選択画面でアスペクト比が縦に長いラベルを選択した際に、PDF枚数が1枚を超えることがある(ライセンス対応)
    * (Other) その他
        * 詳細画面.メモ の縦幅を伸長
        * ラベルデザイン毎に1枚に印刷可能な上限数(目安)の表記を追加  
* ver 0.50  
    * (NEW) 新機能  
        * テスト版 初期リリース  

# 機能
* 検索
    * 前後部分一致
* 追加 / 更新 / 削除
    * 削除のみ複数件同時実行可能
* 画像の追加 / 削除 / 閲覧
    * クリックで大画面閲覧可能
* Tag機能
    * 任意のTag作成 / 削除
        * 色、結晶系、雰囲気、等々 自分の好きな切り口で鉱物をジャンル分けできます
    * 鉱物とTagの紐づけ
		* 複数のTagに紐づけ可能
* ラベル作成  

# 使い方
## 起動方法
* 解凍したフォルダ内にあるMineralManager.exeをダブルクリックしてください
* 解凍したフォルダ内にあるDBフォルダは削除したり移動・改変を行わないでください  
(MineralManager.exeと同一フォルダに存在することが求められますのでデスクトップなどに配置したい場合は、MineralManager.exeのショーカットを作成してください)
## 操作方法
* 検索
    * メイン画面の上部 [keyword] に検索したい文字を入力してください
    * 入力と同時に検索処理が動作します(前後部分一致検索)
    * 検索処理はメイン画面の一覧表に表示されているすべての列を対象に動作します
* 追加
    * メイン画面下部 [Add Mineral]ボタンを押下してください  
    * 詳細画面が開きますので、必要項目を入力して [Save] ボタンを押下してください
        * [MainMineral] は必須項目となっています
* 更新
    * メイン画面中部の一覧表より、対象としたい行をダブルクリックしてください
        * 複数行の更新機能は実装されていません
    * 詳細画面が開きますので、必要項目を修正して [Save] ボタンを押下してください
        * [MainMineral] は必須項目となっています
* 削除
    * メイン画面中部の一覧表より、対象としたい行を選択して、メイン画面下部 [Delete Mineral] ボタンを押下してください
        * 複数行の削除機能に対応しています
        * 確認ダイアログが表示されますが、一度削除した行は復活しないのでご注意ください
* Tag編集
    * メイン画面上部の [Edit Tag] ボタンを押下してください
    * Tag編集画面が開き、現在登録されているTag一覧が表示されます
        * [Refference] 列は現在そのTagが使用されている数を表しています
    * Tagの新規追加を行いたい場合はTag編集画面下部の [Add] ボタンを押下してください  
    一覧表の最終行に新規行が作成されます  
    * Tag名の編集を行いたい場合はTag編集画面の一覧表より、対象としたい行をダブルクリックしてください
    * Tagを削除したい場合は対象としたい行を選択の上、 [Delete]] ボタンを押下してください
        * 確認ダイアログが表示されますが、一度削除した行は復活しないのでご注意ください
        * Tagを削除した場合、各鉱物に紐づいていたそのTag情報も合わせて削除されます
* ラベル作成
    * メイン画面中部の一覧表より、対象としたい行を選択の上、画面上部の [Label Create] ボタンを押下してください
        * 複数行の選択に対応しています
        * ライセンスの都合で一度に作成できるラベルは1ページまでとなります   
        それ以上は複数回に分けて作成を行ってください  
        1枚を超えた場合はエラーとなります
* 画像閲覧
    * マウスホイールで縮小 / 拡大が可能です
    * ドラッグで画像位置の変更が可能です
    * 右クリックまたは [Esc] キーの押下で元の画像サイズに戻ります

# 注意点
* 開発者(@no_katsu)は動作保証をしません、また本アプリケーション使用によって生じたいかなるトラブルの責任も取りません
* 登録した画像データはDBフォルダにコピーされるので大容量データを取り扱う場合にはドライブの残容量にご注意ください

# おねがい
* バグを踏んだら@no_katsuまでご連絡ください
* カッコイイCSSを書ける方はぜひ@no_katsuにお送りください、ラベルテンプレートに採用させていただきます

# わかる人向け
## バックアップとラベルレイアウトについて
鉱物やTagのデータはJSON形式でDBフォルダ内に保存されますので定期的にバックアップをお勧めします  
  
LabelデザインはCSSで定義しており、コード内でHTMLを生成 → PDF化しています  
なのでCSSだけ@no_katsuに送っていただければテンプレートとして採用するように頑張ります  
(将来的にはCSSの取込機能を実装しようかな？)

## 開発後記
背景としては、.NET Core 3.0がWPFに対応したので作りました  
Self-containedで.NET Coreがインストールされてない環境でも動作するのはとても強いですね  
WPFは今回初めて触りましたが関連ライブラリが.NET Standard対応しておらず、車輪の再発明をたくさんしました…  

# 全部読んでくれてありがとうございます
使っていると他の人の石も見てみたくなりますよね！  
検索できるといいなぁ、<font color="Tomato">"他人の石が見たい"</font>って  

# コピーライト
Copyright 2019, ([@no_katsu](https://twitter.com/#!/no_katsu "twitter@no_katsu")).  

* 再配布およびそれに類する行為を禁止します
    * 正規のダウンロードURLを告知する行為は含みません、実行ファイルや設定ファイル等を直接再配布する行為を指します
* リバースエンジニアリングやデコンパイルおよびそれに類する行為を禁止します
* 改変行為を禁止します
* 商用利用を禁止します
    * 有償無償を問わず販売行為を指します
	* 業務での利用を制限しません  

# 利用ライブラリ
* AngleSharp(https://anglesharp.github.io/)
* SelectPdf(https://selectpdf.com/community-edition/)
* Dropbox Inc.(https://www.dropbox.com/developers)
* James Willock/Mulholland Software Ltd(http://materialdesigninxaml.net/)