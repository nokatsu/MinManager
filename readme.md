# これなに？
**MinManager** は鉱物コレクションを管理するためのアプリケーションです  
デスクトップアプリケーションとして作成しているため、 OFFLINE で動作します  
(ONLINE機能以外では) 外部と通信しないので安心してお使いいただけます  

# デモ
![demo](https://raw.githubusercontent.com/wiki/nokatsu/MinManager/images/MineralManager2.gif)

# ダウンロード / アップデート方法
## ダウンロード
下記リンクの赤枠部分をクリックしてDLしてください  
https://github.com/nokatsu/MinManager/releases/tag/v1.1.0

![dl](https://raw.githubusercontent.com/wiki/nokatsu/MinManager/images/dl.jpg)

## アップデート
すでに過去Versionをご使用の方はZIPファイル内 [MinManager.exe] **のみ** を既存フォルダに上書してください  
<font color="Tomato">**同梱の [DB] フォルダをコピーすると今まで登録されたデータが上書されてしまいます**</font>  

## 履歴
* **v1.1.0 (Latest release)**
    * (NEW) 新機能
        * 簡易レポート機能 実装
    * (OTHER)その他
        * オンライン機能へのリンクが大きくわかりやすくなった
* **v1.0.0**
    * (NEW) 新機能
        * (偉大なる) 初期リリース

# 機能
* 検索
    * 前後部分一致
* 追加 / 更新 / 削除
    * 削除のみ複数件同時実行可能
* 画像の追加 / 削除 / 閲覧
    * クリックで大画面閲覧可能
* Tag機能
    * 任意のTag作成 / 削除
        * 色、結晶系、雰囲気、等々 自分の好きな切り口で鉱物をジャンル分けできます
    * 鉱物とTagの紐づけ
		* 複数のTagに紐づけ可能
* ラベル作成  
* レポート表示
* オンライン機能 (おまけ)
    * 鉱物情報をオンライン上で共有できます
        * 公開した情報はMinManagerのみで閲覧可能です
    * ステータス設定が可能です
        * 公開のみ、放出可能、販売中、等
    * 公開範囲設定が可能です
        * 全体公開、相互フォローのみ、等

# 使い方
## 対応OS
* Windowsのみ対応です
    * 他OS(macなど)への対応予定はありません(WPFなのでできません)
## 起動方法
* 解凍したフォルダ内にあるMinManager.exeをダブルクリックしてください
* 解凍したフォルダ内にあるDBフォルダは削除したり移動・改変を行わないでください  
(MinManager.exeと同一フォルダに存在することが求められますのでデスクトップなどに配置したい場合は、MinManager.exeのショートカットを作成してください)
## 操作方法
* 検索
    * メイン画面の上部 [keyword] に検索したい文字を入力してください
    * 入力と同時に検索処理が動作します(前後部分一致検索)
    * 検索処理はメイン画面の一覧表に表示されているすべての列を対象に動作します
* 追加
    * メイン画面下部 [Add Mineral]ボタンを押下してください  
    * 詳細画面が開きますので、必要項目を入力して [Save] ボタンを押下してください
        * [MainMineral] は必須項目となっています
* 更新
    * メイン画面中部の一覧表より、対象としたい行をダブルクリックしてください
        * 複数行の更新機能は実装されていません
    * 詳細画面が開きますので、必要項目を修正して [Save] ボタンを押下してください
        * [MainMineral] は必須項目となっています
* 削除
    * メイン画面中部の一覧表より、対象としたい行を選択して、メイン画面下部 [Delete Mineral] ボタンを押下してください
        * 複数行の削除機能に対応しています
        * 確認ダイアログが表示されますが、一度削除した行は復活しないのでご注意ください
* Tag編集
    * メイン画面上部の [Edit Tag] ボタンを押下してください
    * Tag編集画面が開き、現在登録されているTag一覧が表示されます
        * [Refference] 列は現在そのTagが使用されている数を表しています
    * Tagの新規追加を行いたい場合はTag編集画面下部の [Add] ボタンを押下してください  
    一覧表の最終行に新規行が作成されます  
    * Tag名の編集を行いたい場合はTag編集画面の一覧表より、対象としたい行をダブルクリックしてください
    * Tagを削除したい場合は対象としたい行を選択の上、 [Delete]] ボタンを押下してください
        * 確認ダイアログが表示されますが、一度削除した行は復活しないのでご注意ください
        * Tagを削除した場合、各鉱物に紐づいていたそのTag情報も合わせて削除されます
* ラベル作成
    * メイン画面中部の一覧表より、対象としたい行を選択の上、画面上部の [Label Create] ボタンを押下してください
        * 複数行の選択に対応しています
        * ライセンスの都合で一度に作成できるラベルは1ページまでとなります   
        それ以上は複数回に分けて作成を行ってください  
        1枚を超えた場合はエラーとなります
* 画像閲覧
    * マウスホイールで縮小 / 拡大が可能です
    * ドラッグで画像位置の変更が可能です
    * 右クリックまたは [Esc] キーの押下で元の画像サイズに戻ります
* レポート表示
    * メイン画面上部の[View Reports]ボタンを押下してください
    * レポート閲覧画面が開き、登録されているデータ上最も古い購入日付から現在までの集計レポートが表示されます
        * レポート閲覧画面上部の3つの円グラフはそれぞれ鉱物、国、値段の構成比率を表します
        * レポート閲覧画面下部の積み上げグラフは時系列ごとの鉱物情報を表します
            * 積み上げグラフは、対象とする期間(月単位)を設定可能です。設定後 [Redraw] ボタンを押下することで適用されます
                * [Including NULL Date Data] チェックボックスをオフにすると購入日時が設定されていないデータを集計の対象外とすることができます
            * 積み上げグラフと連動して設定された期間に購入した鉱物の合計金額を表示します
                * 購入日時が設定されていないデータは期間の最初に計上されます



# 注意点
* 開発者(@no_katsu)は動作保証をしません、また本アプリケーション使用によって生じたいかなる損害に関して、一切の責任を負いかねます
* 登録した画像データはDBフォルダにコピーされるので大容量データを取り扱う場合にはドライブの残容量にご注意ください

# おねがい
* 要望があったり、バグを踏んだら@no_katsuまでご連絡ください
* おしゃれ CSS を書ける方はぜひ @no_katsu にお送りください、ラベルテンプレートに採用させていただきます
    * LabelデザインはCSSで定義しており、コード内でHTMLを生成 → PDF化しています

# わかる人向け
## バックアップについて
鉱物やTagのデータはJSON形式でDBフォルダ内に保存されますので定期的にバックアップをお勧めします  

## 開発後記
元々の動機は、.NET Core 3.0がWPFに対応したことでした  
最初は .NET Core で WPF ということでクロスプラットフォームで動くと思ってましたがそんなことはなかったです…  
けど Self-contained で .NET Core がインストールされてない環境でも動作するのはとても強いですね  
WPF は今回初めて触りましたが、対応直後ということもあってか関連ライブラリが .NET Standard 対応しておらず、車輪の再発明を何度かするはめになりました…  

# コピーライト
Copyright 2019, ([@no_katsu](https://twitter.com/#!/no_katsu "twitter@no_katsu")).  

* 再配布およびそれに類する行為を禁止します
    * 正規のダウンロードURLを告知する行為は含みません、実行ファイルや設定ファイル等を直接再配布する行為を指します
* リバースエンジニアリングやデコンパイルおよびそれに類する行為を禁止します
* 改変行為を禁止します
* 商用利用を禁止します
    * 有償無償を問わず販売行為を指します
	* 業務での利用を制限しません  

# 利用ライブラリ
* AngleSharp(https://anglesharp.github.io/)
* SelectPdf(https://selectpdf.com/community-edition/)
* Dropbox Inc.(https://www.dropbox.com/developers)
* James Willock/Mulholland Software Ltd(http://materialdesigninxaml.net/)
* Beto Rodriguez(http://lvcharts.net/)